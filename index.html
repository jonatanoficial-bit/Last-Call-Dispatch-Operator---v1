<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Last Call Dispatch Operator</title>

  <!-- ForÃ§ar nÃ£o-cache (ajuda, mas o principal Ã© o ?v nos scripts) -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <link rel="stylesheet" href="./styles.css?v=2025-12-26-01" />
</head>

<body>
  <div class="app">
    <header class="topbar">
      <div class="brand">
        <div class="logo"></div>
        <div class="brandText">
          <div class="title">Last Call Dispatch Operator</div>
          <div class="subtitle">Simulador de Central de EmergÃªncia</div>
        </div>
      </div>

      <div class="hud">
        <div class="hudItem">
          <div class="hudLabel">Turno</div>
          <div class="hudValue" id="hudShift">â€”</div>
        </div>
        <div class="hudItem">
          <div class="hudLabel">Tempo</div>
          <div class="hudValue" id="hudTime">00:00</div>
        </div>
        <div class="hudItem">
          <div class="hudLabel">Pontos</div>
          <div class="hudValue" id="hudScore">0</div>
        </div>
        <div class="hudItem">
          <div class="hudLabel">Chamadas</div>
          <div class="hudValue" id="hudQueue">0</div>
        </div>
      </div>
    </header>

    <main class="grid">
      <section class="card">
        <div class="cardTitle">ConfiguraÃ§Ã£o</div>

        <div class="formRow">
          <label class="label">Cidade</label>
          <select id="citySelect" class="select"></select>
        </div>

        <div class="formRow">
          <label class="label">AgÃªncia</label>
          <select id="agencySelect" class="select">
            <option value="police">PolÃ­cia</option>
            <option value="fire">Bombeiros</option>
          </select>
        </div>

        <div class="formRow">
          <label class="label">Dificuldade</label>
          <select id="difficultySelect" class="select">
            <option value="easy">FÃ¡cil</option>
            <option value="normal" selected>Normal</option>
            <option value="hard">DifÃ­cil</option>
          </select>
        </div>

        <div class="btnRow">
          <button id="btnStartShift" class="btnPrimary">Iniciar Turno</button>
          <button id="btnEndShift" class="btnGhost" disabled>Encerrar Turno</button>
        </div>

        <div class="hint">
          Regra do jogo: vocÃª <b>atende</b> e depois faz <b>despacho manual</b>. Se for trote, o correto Ã© <b>encerrar</b>.
        </div>
      </section>

      <section class="card">
        <div class="cardTitle">Unidades</div>
        <div id="unitsList" class="list"></div>
        <div class="hint">Dica: cada unidade tem funÃ§Ã£o (role). Enviar errado dÃ¡ penalidade.</div>
      </section>

      <section class="card">
        <div class="cardTitle">Registro</div>
        <pre id="log" class="log"></pre>
      </section>

      <section class="card">
        <div class="cardTitle">OperaÃ§Ã£o</div>

        <div class="pills">
          <div class="pill" id="pillStatus">Turno parado</div>
          <div class="pill pillWarn" id="pillCallTimer">Sem chamada</div>
        </div>

        <div class="subCard">
          <div class="subTitle">ðŸ“ž Chamada Atual</div>
          <div class="meta" id="callMeta">â€”</div>
          <div class="callBox" id="callText">Inicie um turno para receber chamadas.</div>

          <div class="btnRow">
            <button id="btnAnswer" class="btnPrimary" disabled>Atender prÃ³xima</button>
            <button id="btnHold" class="btnGhost" disabled>Colocar em espera</button>
          </div>
        </div>

        <div class="subCard">
          <div class="subTitle">ðŸš“ Despacho Manual</div>
          <div class="meta" id="dispatchInfo">â€”</div>

          <label class="label" style="margin-top:8px;">Escolha a unidade</label>
          <select id="dispatchUnitSelect" class="select" disabled></select>

          <div class="btnRow">
            <button id="btnDispatch" class="btnPrimary" disabled>Despachar</button>
            <button id="btnDismiss" class="btnGhost" disabled>Encerrar chamada</button>
          </div>

          <div class="hint">VocÃª pontua por escolher a unidade certa (ou encerrar trote) dentro do tempo.</div>
        </div>
      </section>

      <section class="card">
        <div class="cardTitle">Fila de Chamadas</div>
        <div id="queueList" class="queue">â€”</div>
      </section>

      <section class="card">
        <div class="cardTitle">Resumo do Turno</div>
        <div id="shiftSummary" class="summary">Nenhum turno ativo.</div>
      </section>
    </main>
  </div>

  <!-- MUITO IMPORTANTE: ordem e cache-busting -->
  <script src="./data/cities.js?v=2025-12-26-01"></script>
  <script src="./data/calls.js?v=2025-12-26-01"></script>
  <script src="./script.js?v=2025-12-26-01"></script>
</body>
</html>